<html>
<head>
<title>{{ page.title }} | Creative Commons Resource Archive</title>
<link rel="stylesheet" type="text/css" href="/style.css" />

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js">
</script>

	{% if page.title == "All" %}

<script>
function getUrlVars()
{
    var vars = [], hash;
    var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
    for(var i = 0; i < hashes.length; i++)
    {
        hash = hashes[i].split('=');
        vars.push(hash[0]);
        vars[hash[0]] = hash[1];
    }
    return vars;
}

function UpdateQueryString(key, value, url) {
    if (!url) url = window.location.href;
    var re = new RegExp("([?|&])" + key + "=.*?(&|#|$)(.*)", "gi");

    if (re.test(url)) {
        if (typeof value !== 'undefined' && value !== null)
            return url.replace(re, '$1' + key + "=" + value + '$2$3');
        else {
            var hash = url.split('#');
            url = hash[0].replace(re, '$1$3').replace(/(&|\?)$/, '');
            if (typeof hash[1] !== 'undefined' && hash[1] !== null) 
                url += '#' + hash[1];
            return url;
        }
    }
    else {
        if (typeof value !== 'undefined' && value !== null) {
            var separator = url.indexOf('?') !== -1 ? '&' : '?',
                hash = url.split('#');
            url = hash[0] + separator + key + '=' + value;
            if (typeof hash[1] !== 'undefined' && hash[1] !== null) 
                url += '#' + hash[1];
            return url;
        }
        else
            return url;
    }
}

document.write("<style>.thumbnailbox { display: none; }</style>");

function RemoveQueryString(param1) {
	var quer = param1
	location.href=location.href.replace(/&?quer=([^&]$|[^&]*)/i, "");
	}

var topic = getUrlVars()["topic"];
var language = getUrlVars()["language"];
var medium = getUrlVars()["medium"];

if (topic === undefined && medium === undefined && language === undefined) {
document.write("<style>.thumbnailbox { display: block; }</style>");
}
else {
	document.write("<style>");
	if (topic != undefined) {document.write("."+topic)};
	if (medium != undefined) {document.write("."+medium)};
	if (language != undefined) {document.write("."+language)};
	document.write(" { display: block; }</style>");
	};

document.write("<style>");
 if (topic != undefined) {document.write(" .resourcenavtopicknown");}
	else {document.write(" .resourcenavtopicunknown");};
 if (medium != undefined) {document.write(", .resourcenavmediumknown");}
	else {document.write(", .resourcenavmediumunknown");};
 if (language != undefined) {document.write(", .resourcenavlanguageknown");}
	else {document.write(", .resourcenavlanguageunknown");};
 document.write(" { display: block; }</style>");
</script>

	{% endif %}

	{% assign topicfilter = page.topicfilter %}
	{% assign mediumfilter = page.mediumfilter %}
	{% assign languagefilter = page.languagefilter %}
	{% assign title == page.title %}


</head>


<body>

	{% include header.html %}

<h1>
	{% unless page.title == 'home' %}
		<a href="/">
	{% endunless %}
Creative Commons Resource Archive
	{% unless page.title == 'home' %}
		</a>
	{% endunless %}
</h1>

{{content}}

	{% if page.title == "All" %}
<div id="resourcenavbar">

<div class="resourcenav resourcenavtopicknown">
<h2>Topic</h2>
<p><script>document.write(topic);</script> [<a onclick="location.href=location.href.replace(/&?topic=([^&]$|[^&]*)/i, '');" href="#">x</a>]</p>
</div>

<div class="resourcenav resourcenavtopicunknown">
<h2>Topic</h2>
<ul>
	{% for topic in site.data.topics %}
		<li><a onclick="window.location.search += '&topic={{ topic.string }}';" href="#">{{ topic.name }}</a></li>
	{% endfor %}
<!-- <li><a onclick="window.location.search += '&topic=licenses';" href="#">Licenses</a></li>
<li><a onclick="window.location.search += '&topic=publicdomain';" href="#">Public Domain</a></li>
<li><a onclick="window.location.search += '&topic=oer';" href="#">Open Educational Resources</a></li>
<li><a onclick="window.location.search += '&topic=oa';" href="#">Open Access</a></li>
<li><a onclick="window.location.search += '&topic=science';" href="#">Science</a></li>
<li><a onclick="window.location.search += '&topic=openpolicy';" href="#">Open Policy</a></li> -->
</ul>
</div>

<div class="resourcenav resourcenavmediumknown">
<h2>Medium</h2>
<p><script>document.write(medium);</script> [<a onclick="location.href=location.href.replace(/&?medium=([^&]$|[^&]*)/i, '');" href="#">x</a>]</p>
<p></p>
</div>

<div class="resourcenav resourcenavmediumunknown">
<h2>Medium</h2>
<ul>
<li><a onclick="window.location.search += '&medium=print';" href="#">Print</a></li>
<li><a onclick="window.location.search += '&medium=website';" href="#">Website</a></li>
<li><a onclick="window.location.search += '&medium=slides';" href="#">Slides</a></li>
<li><a onclick="window.location.search += '&medium=course';" href="#">Course</a></li>
</ul>
</div>

<div class="resourcenav resourcenavlanguageknown">
<h2>Language</h2>
<p><script>document.write(language);</script> [<a onclick="location.href=location.href.replace(/&?language=([^&]$|[^&]*)/i, '');" href="#">x</a>]</p>
</div>

<div class="resourcenav resourcenavlanguageunknown">
<h2>Language</h2>
<p><a onclick="window.location.search += '&language=es';" href="#">ES</a> <a onclick="window.location.search += '&language=ca';" href="#">CA</a> <a onclick="window.location.search += '&language=da';" href="#">DA</a> <a onclick="window.location.search += '&language=de';" href="#">DE</a> <a onclick="window.location.search += '&language=en';" href="#">EN</a> <a onclick="window.location.search += '&language=eo';" href="#">EO</a> <a onclick="window.location.search += '&language=fr';" href="#">FR</a> <a onclick="window.location.search += '&language=hr';" href="#">HR</a> <a onclick="window.location.search += '&language=id';" href="#">ID</a> <a onclick="window.location.search += '&language=sv';" href="#">SV</a> </p>
</div>
</div>

	{% endif %}



<div id="thumbnaillist">

	{% for i in (1..16) %}
		{% for page in site.pages %}
			{% if page.layout == 'resource' %}
				{% if page.featured == i %}
					{% if page.topic contains topicfilter or topicfilter == null %}
					{% if page.medium contains mediumfilter or mediumfilter == null %}
					{% if page.language contains languagefilter or languagefilter == null %}
						<div class="thumbnailbox {{ page.topic }} {{ page.medium }} {{page.language}}">
						<a href="{{ page.permalink }}">
						<div class="thumbnailtitle"><h3>{{ page.title }}</h3></div>
						<div class="thumbnail" style="background-image: url('{{ page.image-thumb }}'); "></div>
						</a>
						<div class="thumbnailblurb">{{ page.blurb }}</div>
						</div>
					{% endif %}{% endif %}{% endif %}
				{% endif %}
			{% endif %}
		{% endfor %}
	{% endfor %}

{% unless page.title == 'home' %}
	{% for i in (1..4) %}
		{% for page in site.pages %}
			{% if page.layout == 'resource' %}
				{% if page.weight == i %}
					{% unless page.featured %}
						{% if page.{{paramfilter}} == page.{{paramvalue %}
					{% if page.topic contains topicfilter or topicfilter == null %}
					{% if page.medium contains mediumfilter or mediumfilter == null %}
					{% if page.language contains languagefilter or languagefilter == null %}
							<div class="thumbnailbox {{ page.topic }} {{ page.medium }} {{page.language}}">
							<a href="{{ page.permalink }}">
							<div class="thumbnailtitle"><h3>{{ page.title }}</h3></div>
							<div class="thumbnail" style="background-image: url('{{ page.image-thumb }}'); "></div>
							</a>
							<div class="thumbnailblurb">{{ page.blurb }}</div>
							</div>
					{% endif %}{% endif %}{% endif %}
						{% endif %}
					{% endunless %}
				{% endif %}
			{% endif %}
		{% endfor %}
	{% endfor %}
{% endunless %}

</div>



</body>
</html>
